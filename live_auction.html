<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Auctioneer</title>
    <link rel="icon" href="assets/images/auction.jpg" type="image/x-icon" />
    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
    />

    <!-- Latest compiled and minified CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />

    <!-- Custom fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Lexend+Mega&family=Montserrat:wght@100&family=Yusei+Magic&family=Josefin+Sans&display=swap"
      rel="stylesheet"
    />
    <!-- Fontawesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />

    <link rel="stylesheet" href="assets/css/style_1.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
  </head>
  <body>
    <!-- The navigation bar 
-------Navbar start  -->
    <nav class="navbar navbar-expand-md navbar-custom sticky-top py-3">
      <div class="container">
        <!-- Brand -->
        <a class="navbar-brand" href="index.html">Auctioneer</a>

        <!-- Toggler/collapsibe Button -->
        <button
          class="navbar-toggler navbar-dark"
          type="button"
          data-toggle="collapse"
          data-target="#collapsibleNavbar"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar links -->
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item">
              <a class="nav-link" href="new_tender.html">New Listing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Active Auctions</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">My Auctions</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Announcements</a>
            </li>
          </ul>
          <ul class="navbar-nav ms-auto">
            <li
              class="nav-item profile"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-placement-md="left"
              title="Profile"
            >
              <a href="#">
                <i class="fas fa-user-circle fa-2x"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Navbar end -->
    <div> 
        <ul class="list-group" id="noticeDisplay">
  
        </ul>
      </div>
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Some custom JS -->

    <!-- <script src="app.js"></script> -->

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const currentUser = String(urlParams.get("username"));

      //DB
      var DB;

      // Add Event Listener [on Load]
      document.addEventListener("DOMContentLoaded", () => {
        // create the database
        let UsersDB = indexedDB.open("users", 1);

        // if there's an error
        UsersDB.onerror = function () {
          console.log("There was an error");
        };
        // if everything is fine, assign the result to the instance
        UsersDB.onsuccess = function () {
          console.log("Database Ready");

          DB = UsersDB.result;
          displayTask();
        };

        console.log(currentUser);

        const profile = document.querySelector(".profile");
        profile.addEventListener("click", function () {
          window.location.href = `profile.html?username=${currentUser}`;
        });

        function displayTask() {
          var transaction = DB.transaction(["users"]);
          var objectStore = transaction.objectStore("users");
          var request = objectStore.get(currentUser);

          request.onsuccess = function (event) {
            if (request.result) {
              console.log(request.result);
            } else {
              console.log("No data record");
            }
          };

          request.onerror = function (event) {
            console.log("Transaction failed");
          };
        }
      });
    </script>
  </body>
</html>
